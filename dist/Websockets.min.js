!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";var o=n(2),i=o(n(3)),r=o(n(4)),s=o(n(5)),c=o(n(6));function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,c.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,r.default)(this,e),(0,c.default)(this,"endpoint",""),(0,c.default)(this,"options",{}),(0,c.default)(this,"client",null),(0,c.default)(this,"_events",{}),"object"===(0,i.default)(t)?(n=t,this.endpoint=""):this.endpoint=t,this.options=u(u({},e.DEFAULT_OPTIONS),n),"http:"===window.location.protocol&&"wss"===this.options.sheme)throw new Error("[Err] Websockets.url - cannot use WebSockets in a mixed environment : do not open a secure WebSocket connection from a page loaded using HTTP.");if("https:"===window.location.protocol&&"ws"===this.options.sheme)throw new Error("[Err] Websockets.url - cannot use WebSockets in a mixed environment : do not open a non-secure WebSocket connection from a page loaded using HTTPS.")}return(0,s.default)(e,[{key:"sheme",get:function(){return"auto"!==this.options.sheme?this.options.sheme:"https"===window.location.protocol?"wss":"ws"}},{key:"url",get:function(){var e=/^(wss?:)?\/\//.test(this.options.base_url)?this.options.base_url:"".concat(this.sheme,"://").concat(this.options.base_url.replace(/^(https?:)?\/\//,""));return null===this.options.port||e.endsWith(this.options.port)||(e+=":".concat(this.options.port.toString())),"".concat(e.replace(/\/$/,""),"/").concat(this.endpoint)}},{key:"isInitialized",get:function(){return null!==this.client}},{key:"isConnecting",get:function(){return this.isInitialized&&this.client.readyState===WebSocket.CONNECTING}},{key:"isOpen",get:function(){return this.isInitialized&&this.client.readyState===WebSocket.OPEN}},{key:"isSending",get:function(){return this.isInitialized&&this.client.bufferedAmount>0}},{key:"isClosed",get:function(){return this.isInitialized&&(this.client.readyState===WebSocket.CLOSING||this.client.readyState===WebSocket.CLOSED)}},{key:"events",get:function(){return this._events}}],[{key:"DEFAULT_OPTIONS",get:function(){return{namespace:"",sheme:"auto",base_url:window.location.hostname,port:null,protocols:[],debug:!1,onerror:function(){throw new Error("[Err] Websockets - unhandled error")},onclose:function(){},onopen:function(){}}}},{key:"CLOSE_CODES",get:function(){return{1e3:"Normal closure",1001:"Going Away",1002:"Protocol Error",1003:"Unsupported Data",1005:"No Status Received",1006:"Abnormal Closure",1007:"Invalid frame payload data",1008:"Policy Violation",1009:"Message too big",1010:"Missing Extension",1011:"Internal Server Error",1012:"Service Restart",1013:"Try Again Later",1014:"Bad Gateway",1015:"TLS Handshake"}}},{key:"DEFAULT_EVENTS",get:function(){return{CONNECTED:"_connected",MESSAGE:"_message"}}}]),(0,s.default)(e,[{key:"connect",value:function(){var t=this;try{this.client=new WebSocket(this.url,this.options.protocols),this.client.onerror=function(e){t.options.onerror(e)},this.client.onopen=function(n){t.isOpen&&(t._messagesHandler(),t.emit(e.DEFAULT_EVENTS.CONNECTED),t.options.onopen(n),t.client.onclose=function(n){var o=e.CLOSE_CODES[n.code]?e.CLOSE_CODES[n.code]:"Unknown Reason";t.options.onclose(n,o)})}}catch(e){throw new Error("[Err] Websockets.connect - error on socket connexion \n"+e)}}},{key:"send",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this._checkConnection(),!this.isClosed){try{"string"==typeof e||e instanceof ArrayBuffer||e instanceof Blob||(e=JSON.stringify(e)),this.client.send(e),this._debug("Message sended.\npayload : ".concat(JSON.stringify(e)),"send")}catch(e){throw new Error("[Err] Websockets.send - ".concat(e.message))}return this}}},{key:"emit",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._checkConnection(),!0===o&&(e=this._namespacedType(e)),new Promise((function(o,i){try{t.send({type:e,payload:n}),t._debug("Event '".concat(e,"' emitted."),"emit"),t.onProgess((function(t){return t&&o(e)}))}catch(e){i(e)}}))}},{key:"on",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._checkConnection(),!0===n&&(e=this._namespacedType(e)),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this._debug("Event '".concat(e,"' added successfully"),"on"),this}},{key:"onProgess",value:function(e){var t=this,n=window.setInterval((function(){var o=0===t.client.bufferedAmount;e(o,t.client.bufferedAmount),o&&clearInterval(n)}),100);return this}},{key:"onMessage",value:function(t){return this.on(e.DEFAULT_EVENTS.MESSAGE,t)}},{key:"disconnect",value:function(){var e=this;this._checkConnection(),this.isSending?window.setTimeout((function(){return e.disconnect()}),500):(this.client.close(),this._debug("Websockets successfully disconnected","disconnect"))}},{key:"_checkConnection",value:function(){if(this.isClosed)throw new Error("[Err] Websockets._checkConnection - connection closed.")}},{key:"_messagesHandler",value:function(){var t=this;this.client.onmessage=function(n){var o;try{o=JSON.parse(n.data)}catch(e){o=n.data}t._dispatchEvents(e.DEFAULT_EVENTS.MESSAGE,o),void 0!==o.type&&t._dispatchEvents(o.type,o)}}},{key:"_dispatchEvents",value:function(e,t){this._events[e]&&(this._debug("'".concat(e,"' dispatched"),"_dispatchEvents"),this._events[e].forEach((function(e){return e(t)})))}},{key:"_namespacedType",value:function(e){return""===this.options.namespace||e.startsWith(this.options.namespace)?e:"".concat(this.options.namespace,"_").concat(e)}},{key:"_debug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!0===this.options.debug&&(t=null!==t?".".concat(t):"",console.info("[DEBUG] Websockets".concat(t," - ").concat(e)))}}]),e}();"Websockets"in window||(window.Websockets=l)},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}]);