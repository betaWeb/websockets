!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";(function(t){var o=n(3),i=o(n(4)),r=o(n(5)),s=o(n(6));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,i.default)(this,e),(0,s.default)(this,"options",{}),(0,s.default)(this,"client",null),(0,s.default)(this,"_events",{}),this.options=a(a({},e.DEFAULT_OPTIONS),t),"http:"===window.location.protocol&&"wss"===this.options.scheme)throw new Error("[Err] Websockets.url - cannot use WebSockets in a mixed environment : do not open a secure WebSocket connection from a page loaded using HTTP.");if("https:"===window.location.protocol&&"ws"===this.options.scheme)throw new Error("[Err] Websockets.url - cannot use WebSockets in a mixed environment : do not open a non-secure WebSocket connection from a page loaded using HTTPS.")}return(0,r.default)(e,[{key:"scheme",get:function(){return"auto"!==this.options.scheme?this.options.scheme:"https"===window.location.protocol?"wss":"ws"}},{key:"url",get:function(){var e=/^(wss?:)?\/\//.test(this.options.base_url)?this.options.base_url:"".concat(this.scheme,"://").concat(this.options.base_url.replace(/^(https?:)?\/\//,""));return null===this.options.port||e.endsWith(this.options.port)||(e+=":".concat(this.options.port.toString())),e=e.replace(/\/$/,""),""!==this.options.endpoint?"".concat(e,"/").concat(this.options.endpoint):e}},{key:"isInitialized",get:function(){return null!==this.client}},{key:"isConnecting",get:function(){return this.isInitialized&&this.client.readyState===WebSocket.CONNECTING}},{key:"isOpen",get:function(){return this.isInitialized&&this.client.readyState===WebSocket.OPEN}},{key:"isSending",get:function(){return this.isInitialized&&this.client.bufferedAmount>0}},{key:"isClosed",get:function(){return this.isInitialized&&(this.client.readyState===WebSocket.CLOSING||this.client.readyState===WebSocket.CLOSED)}},{key:"events",get:function(){return this._events}}],[{key:"DEFAULT_OPTIONS",get:function(){return{endpoint:"",namespace:"",scheme:"auto",base_url:window.location.hostname,port:null,protocols:[],debug:!1,onerror:function(){throw new Error("[Err] Websockets - unhandled error")},onclose:function(){},onopen:function(){},onprogress:null}}},{key:"CLOSE_CODES",get:function(){return{1e3:"Normal closure",1001:"Going Away",1002:"Protocol Error",1003:"Unsupported Data",1005:"No Status Received",1006:"Abnormal Closure",1007:"Invalid frame payload data",1008:"Policy Violation",1009:"Message too big",1010:"Missing Extension",1011:"Internal Server Error",1012:"Service Restart",1013:"Try Again Later",1014:"Bad Gateway",1015:"TLS Handshake"}}},{key:"DEFAULT_EVENTS",get:function(){return{CONNECTED:"_connected",MESSAGE:"_message"}}}]),(0,r.default)(e,[{key:"connect",value:function(){var t=this;return new Promise((function(n,o){try{t.client=new WebSocket(t.url,t.options.protocols),t.client.onerror=function(e){t.options.onerror(e),o()},t.client.onopen=function(o){t.isOpen&&(t._messagesHandler(),t.emit(e.DEFAULT_EVENTS.CONNECTED),t.options.onopen(o),t.client.onclose=function(n){var o=e.CLOSE_CODES[n.code]?e.CLOSE_CODES[n.code]:"Unknown Reason";t.options.onclose(n,o)},n())}}catch(e){o(e)}}))}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this._checkConnection();try{if(!("string"==typeof t||t instanceof ArrayBuffer||t instanceof Blob))try{t=JSON.stringify(t)}catch(e){}return new Promise((function(n,o){try{if(e.client.send(t),e._debug("Message sended.\npayload : ".concat(t),"send"),null!==e.options.onprogress)var i=setInterval((function(){e.client.bufferedAmount>0?e.options.onprogress(e.client.bufferedAmount,t):(e.options.onprogress(0,t),clearInterval(i),n())}),100);else n()}catch(e){o(e)}}))}catch(e){throw new Error("[Err] Websockets.send - ".concat(e.message))}}},{key:"emit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._checkConnection(),!0===n&&(e=this._namespacedType(e));try{this.send({type:e,payload:t}),this._debug("Event '".concat(e,"' emitted."),"emit")}catch(e){throw new Error(e)}return this}},{key:"on",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._checkConnection(),!0===n&&(e=this._namespacedType(e)),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this._debug("Event '".concat(e,"' successfully added"),"on"),this}},{key:"off",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._checkConnection(),!0===n&&(e=this._namespacedType(e)),!this._events[e])throw new Error("");return null!==t?(this._events[e]=this._events[e].filter((function(e){return e.toString().replace(/\s+/g,"")!==t.toString().replace(/\s+/g,"")})),0===this._events[e].length&&this.off(e,null,n),this._debug("Event '".concat(e,"' callback successfully removed"),"off")):(delete this._events[e],this._debug("Event '".concat(e,"' successfully removed"),"off")),this}},{key:"onMessage",value:function(t){return this.on(e.DEFAULT_EVENTS.MESSAGE,t)}},{key:"disconnect",value:function(){var e=this;this._checkConnection(),this.isSending?window.setTimeout((function(){return e.disconnect()}),500):(this.client.close(),this._debug("Websockets successfully disconnected","disconnect"))}},{key:"_checkConnection",value:function(){if(this.isClosed)throw new Error("[Err] Websockets._checkConnection - connection closed.")}},{key:"_messagesHandler",value:function(){var t=this;this.client.onmessage=function(n){var o;try{o=JSON.parse(n.data)}catch(e){o=n.data}t._dispatch(e.DEFAULT_EVENTS.MESSAGE,o),void 0!==o.type&&t._dispatch(o.type,o)}}},{key:"_dispatch",value:function(e,t){this._events[e]&&(this._debug("'".concat(e,"' dispatched"),"_dispatch"),this._events[e].forEach((function(e){return e(t)})))}},{key:"_namespacedType",value:function(e){return""===this.options.namespace||e.startsWith(this.options.namespace)?e:"".concat(this.options.namespace,"_").concat(e)}},{key:"_debug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!0===this.options.debug&&(t=null!==t?".".concat(t):"",console.info("[DEBUG] Websockets".concat(t," - ").concat(e)))}}]),e}();void 0!==e.exports&&void 0!==t&&(e.exports=u),"undefined"!=typeof window&&"undefined"!=typeof document&&("Websockets"in window||(window.Websockets=u))}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}]);